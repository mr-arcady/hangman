<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="color-scheme" content="dark light">
    <title>Hangman: Arcade</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- THEME ENGINE --- */
        
        /* 1. Base Defaults (Dark Mode) - This is the fallback if system is Dark or Unknown */
        :root {
            --bg-primary: #111827; 
            --bg-secondary: #1f2937; 
            --text-primary: #ffffff; 
            --text-secondary: #9ca3af;
            --accent-success: #22c55e; 
            --accent-fail: #ef4444; 
            --border-color: #374151;
        }

        /* 2. System Light Mode - Only activates if device explicitly says "I am Light" */
        @media (prefers-color-scheme: light) {
            :root {
                --bg-primary: #f3f4f6; 
                --bg-secondary: #ffffff;
                --text-primary: #111827; 
                --text-secondary: #4b5563;
                --accent-success: #16a34a; 
                --accent-fail: #dc2626; 
                --border-color: #d1d5db;
            }
        }

        /* 3. Manual Overrides (Applied via JS classes) */
        
        /* Force Light: Overrides everything */
        body.force-light {
            --bg-primary: #f3f4f6; 
            --bg-secondary: #ffffff;
            --text-primary: #111827; 
            --text-secondary: #4b5563;
            --accent-success: #16a34a; 
            --accent-fail: #dc2626; 
            --border-color: #d1d5db;
        }

        /* Force Dark: Overrides everything (even if system is light) */
        body.force-dark {
            --bg-primary: #111827; 
            --bg-secondary: #1f2937; 
            --text-primary: #ffffff; 
            --text-secondary: #9ca3af;
            --accent-success: #22c55e; 
            --accent-fail: #ef4444; 
            --border-color: #374151;
        }

        /* 4. Accessibility Overrides (High Contrast) */
        body.high-contrast {
            --accent-success: #2563eb !important; 
            --accent-fail: #ea580c !important; 
            font-weight: 700;
        }
        body.high-contrast .neutral-in-hc {
            border-color: var(--border-color) !important;
            color: var(--text-primary) !important;
            background-color: var(--bg-secondary) !important;
        }
        body.high-contrast .neutral-in-hc:hover {
            background-color: var(--bg-primary) !important;
        }

        /* Dynamic Selected State */
        .theme-selected {
            border-width: 2px;
            border-color: var(--accent-success) !important;
            color: var(--accent-success) !important;
            background-color: rgba(128, 128, 128, 0.1) !important;
        }

        /* Utilities */
        .theme-bg { background-color: var(--bg-primary); }
        .theme-panel { background-color: var(--bg-secondary); }
        .theme-text { color: var(--text-primary); }
        .theme-text-sub { color: var(--text-secondary); }
        .theme-success { color: var(--accent-success); }
        .theme-fail { color: var(--accent-fail); }
        .theme-border { border-color: var(--border-color); }
        
        .theme-btn-success { background-color: var(--accent-success); color: white; }
        .theme-btn-fail { background-color: var(--accent-fail); color: white; }

        .hidden { display: none !important; }
        .btn-press:active { transform: scale(0.95); }
        .disabled-toggle { opacity: 0.5; pointer-events: none; }
        
        #settings-menu { transition: transform 0.3s ease-in-out; }
        .menu-open { transform: translateX(0) !important; }
        .menu-closed { transform: translateX(100%); }
    </style>
</head>
<body class="theme-bg theme-text font-sans min-h-screen flex flex-col items-center justify-center transition-colors duration-300">

    <div class="absolute top-4 right-4 z-50">
        <button onclick="toggleMenu()" class="p-2 rounded theme-panel theme-border border shadow-lg text-2xl">☰</button>
    </div>

    <div id="settings-menu" class="fixed inset-0 z-40 bg-black/50 backdrop-blur-sm flex justify-end menu-closed">
        <div class="theme-panel w-80 h-full p-6 shadow-2xl border-l theme-border flex flex-col">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-xl font-bold uppercase tracking-widest theme-text">Settings</h2>
                <button onclick="toggleMenu()" class="text-2xl theme-text">✕</button>
            </div>
            
            <div class="space-y-6 flex-1">
                <div>
                    <span class="font-bold theme-text-sub block mb-3 text-xs uppercase tracking-widest">Theme</span>
                    <div class="flex gap-2">
                        <button onclick="setTheme('light')" id="btn-theme-light" class="flex-1 p-2 rounded text-xs font-bold border theme-border transition theme-text-sub hover:bg-white/5">Light</button>
                        <button onclick="setTheme('dark')" id="btn-theme-dark" class="flex-1 p-2 rounded text-xs font-bold border theme-border transition theme-text-sub hover:bg-white/5">Dark</button>
                        <button onclick="setTheme('system')" id="btn-theme-system" class="flex-1 p-2 rounded text-xs font-bold border theme-border transition theme-text-sub hover:bg-white/5">System</button>
                    </div>
                </div>

                <div class="flex justify-between items-center">
                    <span class="font-bold theme-text-sub">Accessibility</span>
                    <button onclick="toggleContrast()" id="btn-contrast" class="w-12 h-6 rounded-full bg-gray-600 relative transition"><div class="w-4 h-4 bg-white rounded-full absolute top-1 left-1 transition-all"></div></button>
                </div>

                <hr class="theme-border opacity-50">
                <button onclick="showHelp()" class="w-full p-3 rounded theme-border border font-bold theme-text uppercase tracking-widest hover:opacity-70">How to Play</button>
            </div>
        </div>
    </div>

    <div id="modal-help" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur p-4">
        <div class="theme-panel p-8 rounded-2xl max-w-md w-full border theme-border shadow-2xl relative">
            <button onclick="document.getElementById('modal-help').classList.add('hidden')" class="absolute top-4 right-4 text-2xl theme-text opacity-50 hover:opacity-100">✕</button>
            <h2 class="text-2xl font-bold mb-4 theme-success uppercase italic">Welcome to Hangman</h2>
            <div class="space-y-4 theme-text-sub text-sm leading-relaxed">
                <p>This is the ultimate word-guessing arcade.</p>
                <ul class="list-disc pl-5 space-y-2">
                    <li><strong class="theme-text">Pro Mode (Solo):</strong> Challenge our massive database of films, books, and art.</li>
                    <li><strong class="theme-text">PvP Mode (Multiplayer):</strong> Create a room and challenge friends. One player sets a word, others guess.</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="w-full max-w-md p-6 text-center">
        <h1 class="text-6xl font-black mb-2 theme-success tracking-tighter italic uppercase drop-shadow-lg transition-colors">Hangman</h1>
        <p class="text-sm theme-text-sub uppercase tracking-[0.4em] mb-12 font-bold">Online Arcade</p>

        <div class="space-y-6">
            <a href="https://arcady-hangman-pro.vercel.app/" class="neutral-in-hc block w-full p-6 rounded-xl theme-panel border-2 border-red-500 hover:bg-red-900/10 transition group shadow-xl text-red-500">
                <div class="text-4xl font-black mb-1">PRO</div>
                <div class="text-[10px] theme-text-sub uppercase tracking-widest font-bold">Face the Hangman</div>
            </a>

            <a href="https://arcady-hangman-pvp.vercel.app/" class="neutral-in-hc block w-full p-6 rounded-xl theme-panel border-2 border-blue-500 hover:bg-blue-900/10 transition group shadow-xl text-blue-500">
                <div class="text-4xl font-black mb-1">PVP</div>
                <div class="text-[10px] theme-text-sub uppercase tracking-widest font-bold">Play with Friends</div>
            </a>
        </div>
    </div>

    <script>
        // --- SAFE STORAGE ---
        const memStorage = {};
        function safeSetStorage(key, val) {
            try {
                if(typeof localStorage !== 'undefined' && localStorage) {
                    localStorage.setItem(key, val);
                } else { throw new Error("Blocked"); }
            } catch(e) { memStorage[key] = val; }
        }
        function safeGetStorage(key) {
            try {
                if(typeof localStorage !== 'undefined' && localStorage) {
                    return localStorage.getItem(key);
                } else { throw new Error("Blocked"); }
            } catch(e) { return memStorage[key] || null; }
        }

        // --- SIMPLIFIED THEME LOGIC ---
        function initTheme() {
            try {
                const mode = safeGetStorage('h_theme_mode') || 'system';
                const isContrast = safeGetStorage('h_contrast') === 'true';
                
                applyTheme(mode);
                updateThemeButtons(mode);

                if(isContrast) document.body.classList.add('high-contrast');
                updateContrastToggle();
            } catch(e) { console.log("Theme init error"); }
        }

        function applyTheme(mode) {
            // Clean slate
            document.body.classList.remove('force-light', 'force-dark');

            if (mode === 'light') {
                document.body.classList.add('force-light');
            } else if (mode === 'dark') {
                document.body.classList.add('force-dark');
            } 
            // If 'system', we add NO classes. 
            // The CSS @media (prefers-color-scheme) handles it natively.
        }

        function setTheme(mode) {
            safeSetStorage('h_theme_mode', mode);
            applyTheme(mode);
            updateThemeButtons(mode);
        }

        function updateThemeButtons(mode) {
            ['light', 'dark', 'system'].forEach(m => {
                const btn = document.getElementById(`btn-theme-${m}`);
                if(btn) btn.className = "flex-1 p-2 rounded text-xs font-bold border theme-border transition theme-text-sub hover:bg-white/5"; 
            });
            const active = document.getElementById(`btn-theme-${mode}`);
            if(active) active.className = "flex-1 p-2 rounded text-xs font-bold border theme-border transition theme-selected shadow-lg";
        }

        // --- CONTRAST LOGIC ---
        function toggleContrast() {
            document.body.classList.toggle('high-contrast');
            safeSetStorage('h_contrast', document.body.classList.contains('high-contrast'));
            updateContrastToggle();
            const mode = safeGetStorage('h_theme_mode') || 'system';
            updateThemeButtons(mode);
        }

        function updateContrastToggle() {
            const isContrast = document.body.classList.contains('high-contrast');
            const btn = document.getElementById('btn-contrast').firstElementChild;
            btn.style.transform = isContrast ? 'translateX(24px)' : 'translateX(0)';
            document.getElementById('btn-contrast').style.backgroundColor = isContrast ? '#2563eb' : '#4b5563';
        }

        function toggleMenu() {
            const menu = document.getElementById('settings-menu');
            if(menu.classList.contains('menu-closed')) {
                menu.classList.remove('menu-closed');
                menu.classList.add('menu-open');
            } else {
                menu.classList.remove('menu-open');
                menu.classList.add('menu-closed');
            }
        }

        function showHelp() {
            toggleMenu();
            document.getElementById('modal-help').classList.remove('hidden');
        }

        initTheme();
    </script>
</body>
</html>
