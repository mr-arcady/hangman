<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hangman: Arcade</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- THEME ENGINE (Default = Dark) --- */
        :root {
            --bg-primary: #111827; /* Dark Gray */
            --bg-secondary: #1f2937;
            --text-primary: #ffffff;
            --text-secondary: #9ca3af;
            --accent-success: #22c55e; /* Green */
            --accent-fail: #ef4444; /* Red */
            --border-color: #374151;
        }

        /* Light Mode Override */
        body.light-mode {
            --bg-primary: #f3f4f6; /* Light Gray */
            --bg-secondary: #ffffff;
            --text-primary: #111827;
            --text-secondary: #4b5563;
            --accent-success: #16a34a;
            --accent-fail: #dc2626;
            --border-color: #d1d5db;
        }

        /* Accessibility Override */
        body.high-contrast {
            --accent-success: #2563eb !important; /* Blue */
            --accent-fail: #ea580c !important; /* Orange */
            font-weight: 700;
        }
        
        body.high-contrast .neutral-in-hc {
            border-color: var(--border-color) !important;
            color: var(--text-primary) !important;
            background-color: var(--bg-secondary) !important;
        }
        body.high-contrast .neutral-in-hc:hover {
            background-color: var(--bg-primary) !important;
        }

        /* Utilities */
        .theme-bg { background-color: var(--bg-primary); }
        .theme-panel { background-color: var(--bg-secondary); }
        .theme-text { color: var(--text-primary); }
        .theme-text-sub { color: var(--text-secondary); }
        .theme-success { color: var(--accent-success); }
        .theme-fail { color: var(--accent-fail); }
        .theme-border { border-color: var(--border-color); }
        
        .hidden { display: none !important; }
        .btn-press:active { transform: scale(0.95); }
        
        #settings-menu { transition: transform 0.3s ease-in-out; }
        .menu-open { transform: translateX(0) !important; }
        .menu-closed { transform: translateX(100%); }
    </style>
</head>
<body class="theme-bg theme-text font-sans min-h-screen flex flex-col items-center justify-center transition-colors duration-300">

    <div class="absolute top-4 right-4 z-50">
        <button onclick="toggleMenu()" class="p-2 rounded theme-panel theme-border border shadow-lg text-2xl">☰</button>
    </div>

    <div id="settings-menu" class="fixed inset-0 z-40 bg-black/50 backdrop-blur-sm flex justify-end menu-closed">
        <div class="theme-panel w-80 h-full p-6 shadow-2xl border-l theme-border flex flex-col">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-xl font-bold uppercase tracking-widest theme-text">Settings</h2>
                <button onclick="toggleMenu()" class="text-2xl theme-text">✕</button>
            </div>
            
            <div class="space-y-6 flex-1">
                <div class="flex justify-between items-center">
                    <span class="font-bold theme-text-sub">Light Mode</span>
                    <button onclick="toggleLightMode()" id="btn-light" class="w-12 h-6 rounded-full bg-gray-600 relative transition">
                        <div class="w-4 h-4 bg-white rounded-full absolute top-1 left-1 transition-all"></div>
                    </button>
                </div>

                <div class="flex justify-between items-center">
                    <span class="font-bold theme-text-sub">Accessibility</span>
                    <button onclick="toggleContrast()" id="btn-contrast" class="w-12 h-6 rounded-full bg-gray-600 relative transition">
                        <div class="w-4 h-4 bg-white rounded-full absolute top-1 left-1 transition-all"></div>
                    </button>
                </div>

                <hr class="theme-border opacity-50">
                <button onclick="showHelp()" class="w-full p-3 rounded theme-border border font-bold theme-text uppercase tracking-widest hover:opacity-70">How to Play</button>
            </div>
        </div>
    </div>

    <div id="modal-help" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur p-4">
        <div class="theme-panel p-8 rounded-2xl max-w-md w-full border theme-border shadow-2xl relative">
            <button onclick="document.getElementById('modal-help').classList.add('hidden')" class="absolute top-4 right-4 text-2xl theme-text opacity-50 hover:opacity-100">✕</button>
            <h2 class="text-2xl font-bold mb-4 theme-success uppercase italic">Welcome to Hangman</h2>
            <div class="space-y-4 theme-text-sub text-sm leading-relaxed">
                <p>This is the ultimate word-guessing arcade.</p>
                <ul class="list-disc pl-5 space-y-2">
                    <li><strong class="theme-text">Pro Mode (Solo):</strong> Challenge our massive database of films, books, and art.</li>
                    <li><strong class="theme-text">PvP Mode (Multiplayer):</strong> Create a room and challenge friends. One player sets a word, others guess.</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="w-full max-w-md p-6 text-center">
        <h1 class="text-6xl font-black mb-2 theme-success tracking-tighter italic uppercase drop-shadow-lg transition-colors">Hangman</h1>
        <p class="text-sm theme-text-sub uppercase tracking-[0.4em] mb-12 font-bold">Online Arcade</p>

        <div class="space-y-6">
            <a id="link-pro" href="https://arcady-hangman-pro.vercel.app/" class="neutral-in-hc block w-full p-6 rounded-xl theme-panel border-2 border-red-500 hover:bg-red-900/10 transition group shadow-xl text-red-500">
                <div class="text-4xl font-black mb-1">PRO</div>
                <div class="text-[10px] theme-text-sub uppercase tracking-widest font-bold">Face the Hangman</div>
            </a>

            <a id="link-pvp" href="https://arcady-hangman-pvp.vercel.app/" class="neutral-in-hc block w-full p-6 rounded-xl theme-panel border-2 border-blue-500 hover:bg-blue-900/10 transition group shadow-xl text-blue-500">
                <div class="text-4xl font-black mb-1">PVP</div>
                <div class="text-[10px] theme-text-sub uppercase tracking-widest font-bold">Play with Friends</div>
            </a>
        </div>
    </div>

    <script>
        // --- SAFE STORAGE (Cookie Fallback) ---
        const memStorage = {};
        function safeSetStorage(key, val) {
            try {
                if(typeof localStorage !== 'undefined' && localStorage) {
                    localStorage.setItem(key, val);
                } else { throw new Error("Blocked"); }
            } catch(e) {
                document.cookie = `${key}=${val}; path=/; max-age=31536000`; // Cookie fallback
            }
        }
        function safeGetStorage(key) {
            try {
                if(typeof localStorage !== 'undefined' && localStorage) {
                    return localStorage.getItem(key);
                } else { throw new Error("Blocked"); }
            } catch(e) {
                const match = document.cookie.match(new RegExp('(^| )' + key + '=([^;]+)'));
                return match ? match[2] : null;
            }
        }

        // --- SHARED THEME LOGIC (WITH CROSS-PAGE SYNC) ---
        function initTheme() {
            try {
                // 1. Check URL Params (Priority)
                const params = new URLSearchParams(window.location.search);
                let mode = safeGetStorage('h_theme_mode') || 'dark';
                let isContrast = safeGetStorage('h_contrast') === 'true';

                // If URL has settings, override and save
                if (params.has('theme')) {
                    mode = params.get('theme');
                    safeSetStorage('h_theme_mode', mode);
                }
                if (params.has('contrast')) {
                    isContrast = params.get('contrast') === 'true';
                    safeSetStorage('h_contrast', isContrast);
                }
                
                // 2. Apply
                applySettings(mode, isContrast);
                
            } catch(e) { console.log("Theme init error"); }
        }

        function applySettings(mode, isContrast) {
            if (mode === 'light') {
                document.body.classList.add('light-mode');
            } else {
                document.body.classList.remove('light-mode');
            }

            if (isContrast) {
                document.body.classList.add('high-contrast');
            } else {
                document.body.classList.remove('high-contrast');
            }

            updateToggles();
            updateOutgoingLinks();
        }

        function toggleLightMode() {
            const isLight = document.body.classList.toggle('light-mode');
            const newMode = isLight ? 'light' : 'dark';
            safeSetStorage('h_theme_mode', newMode);
            updateToggles();
            updateOutgoingLinks();
        }

        function toggleContrast() {
            const isContrast = document.body.classList.toggle('high-contrast');
            safeSetStorage('h_contrast', isContrast);
            updateToggles();
            updateOutgoingLinks();
        }

        function updateToggles() {
            const isLight = document.body.classList.contains('light-mode');
            const isContrast = document.body.classList.contains('high-contrast');

            // Light Switch
            const lightBtn = document.getElementById('btn-light').firstElementChild;
            lightBtn.style.transform = isLight ? 'translateX(24px)' : 'translateX(0)';
            document.getElementById('btn-light').style.backgroundColor = isLight ? '#22c55e' : '#4b5563';

            // Contrast Switch
            const contrastBtn = document.getElementById('btn-contrast').firstElementChild;
            contrastBtn.style.transform = isContrast ? 'translateX(24px)' : 'translateX(0)';
            document.getElementById('btn-contrast').style.backgroundColor = isContrast ? '#2563eb' : '#4b5563';
        }

        // --- UPDATES OUTGOING LINKS ---
        // This ensures that when you click Pro or PvP, the current theme travels with you
        function updateOutgoingLinks() {
            const mode = document.body.classList.contains('light-mode') ? 'light' : 'dark';
            const contrast = document.body.classList.contains('high-contrast');
            const query = `?theme=${mode}&contrast=${contrast}`;

            const proLink = document.getElementById('link-pro');
            if(proLink) proLink.href = "https://arcady-hangman-pro.vercel.app/" + query;

            const pvpLink = document.getElementById('link-pvp');
            if(pvpLink) pvpLink.href = "https://arcady-hangman-pvp.vercel.app/" + query;
        }

        function toggleMenu() {
            const menu = document.getElementById('settings-menu');
            if(menu.classList.contains('menu-closed')) {
                menu.classList.remove('menu-closed');
                menu.classList.add('menu-open');
            } else {
                menu.classList.remove('menu-open');
                menu.classList.add('menu-closed');
            }
        }

        function showHelp() {
            toggleMenu();
            document.getElementById('modal-help').classList.remove('hidden');
        }

        // Run immediately on page load
        initTheme();
    </script>
</body>
</html>
